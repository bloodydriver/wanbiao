<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="shop_car.css">
    <link rel="stylesheet" href="submitIndent.css">
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
    <script src="shop_car.js"></script>
    <title>Document</title>
</head>
<body>
    <div class="submitIndent">
        <div class="shopCar_top">
            <div class="header_logo">
                <a href="">
                    <img src="https://static.wbiao.co/p/pc/images/1/logo-icon.png" alt="">
                </a>
                <a href="">
                    <img src="https://static.wbiao.co/p/pc/images/1/slogan-02242018.png" alt="">
                </a>
            </div>
            <div class="header_right">
                <ul>
                    <li class="dot">
                        <i></i>
                        <span>购物车</span>
                    </li>
                    <li class="changeColor">
                        <i></i>
                        <span>填写订单信息</span>
                    </li>
                    <li>
                        <i></i>
                        <span>支付订单</span>
                    </li>
                    <li>
                        <i></i>
                        <span>等待签收</span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="message">
            <div class="L_title">
                <span>
                    <i></i>
                </span>
                <h2>收货人信息<a href="javascript:void(0)">管理收货地址</a></h2>
            </div>
            <div class="L_address">
                <ul>
                </ul>
                <a class="addAddress" href="javascript:void(0)">
                    <span><i></i> 添加收货地址</span>
                </a>
            </div>
        </div>
        <div class="delivery">
            <div class="L_title">
                <span>
                    <i></i>
                </span>
                <h2>送货清单（<span>1</span>）<a href="shop_car.html">返回购物车修改</a></h2>
            </div>
            <div class="shopList">
                <h2>阿玛尼ARMANI（<span>1</span>）</h2> 
                <ul>
                    <!-- <li>
                        <div class="shopMessage">
                            <a href="">
                                <img src="https://image8.wbiao.co/shop/c7fe11add1b24475b1d582b053687469.jpg?x-oss-process=image/resize,w_90,h_90" alt="">
                            </a>
                            <div class="shopContent">
                                <p class="p1">阿玛尼-LUIGI系列 AR1970 石英男表</p>
                                <p class="p2">真皮 黑色</p>
                                <span>七天退换</span>
                            </div>
                            <div class="shopMessage_fl">
                                <span>￥<span class="price">2120</span></span>
                                <div>
                                    <button class="sub" type="button">-</button>
                                    <input class="number" type="text" value="1" disabled>
                                    <button class="add" type="button">+</button>
                                </div>
                                <span class="priceAll" style="font-weight: 700;">￥2120</span>
                            </div>
                        </div>
                    </li> -->
                </ul>
                <h2><span>保障服务 </span>万表名匠手表维修诚信平台</h2>
                <ul class="ul1">
                    <li>
                        <div class="shopMessage">
                            <a href="">
                                <img src="https://image8.wbiao.co/mall/165117ff93814c5fbe64d5b6af93d088.jpg?x-oss-process=image/resize,w_90,h_90" alt="">
                            </a>
                            <div class="shopContent">
                                <p class="p1">万表名匠电池服务-手表维修保养售后</p>
                                
                            </div>
                            <div class="shopMessage_fl">
                                <span class="span1"><span>￥77</span><span class="priceLine">￥128</span></span>
                                <span class="span2">+优惠加购</span>
                                <span class="priceAdd">￥0</span>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="shopMessage">
                            <a href="">
                                <img src="https://image8.wbiao.co/shop/6ad1267c6907474f855e6675b27f3fba.jpg?x-oss-process=image/resize,w_90,h_90" alt="">
                            </a>
                            <div class="shopContent">
                                <p class="p1">万表名匠1年延保服务-手表维修保养售后</p>
                            </div>
                            <div class="shopMessage_fl">
                                <span class="span1"><span>￥143</span><span class="priceLine">￥238</span></span>
                                <span class="span2">+优惠加购</span>
                                <span class="priceAdd" style="font-weight: 700;">￥0</span>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="shopMessage">
                            <a href="">
                                <img src="https://image8.wbiao.co/shop/a0733d95ae334bbca632660c2888ab76.jpg?x-oss-process=image/resize,w_90,h_90" alt="">
                            </a>
                            <div class="shopContent">
                                <p class="p1">万表名匠3年延保服务-手表维修保养售后</p>
                            </div>
                            <div class="shopMessage_fl">
                                <span class="span1"><span>￥197</span><span class="priceLine">￥328</span></span>
                                <span class="span2">+优惠加购</span>
                                <span class="priceAdd" style="font-weight: 700;">￥0</span>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="L_title">
                <span>
                    <i></i>
                </span>
                <h2>发票类型</h2>
            </div>
        <div class="invoice">
            <a href="javascript:void(0)">填写信息</a>
        </div>
        <div class="L_title">
                <span>
                    <i></i>
                </span>
                <h2>优惠券／现金券／礼金券／积分抵用</h2>
            </div>
        <div class="coupon">
            <span>券无可用</span>积分可抵 
            <span>0</span>元
            <a href="javascript:void(0)">修改</a>
        </div>
        <div class="L_title">
                <span>
                    <i></i>
                </span>
                <h2>留言</h2>
            </div>
        <div class="leave_msg">
            <div>
                <textarea class="msg_area" id="msg_area" maxlength="200" placeholder="请输入..."></textarea>
                <span>0/200</span>
            </div>
            
        </div>
        <div class="pay_price">
            <p>商品总额<span>￥0</span></p>
            <p>活动优惠<span>￥0</span></p>
            <p>优惠<span>￥0</span></p>
            <p>运费<span>￥0</span></p>
        </div>
        <div class="L_submit">
            <span>提交订单</span>
            <p>应付款<span>￥0</span></p>
        </div>
    </div>
    <div class="shade">
        <div class="edit_box">
            <h2>
                <span>添加收货地址</span>
                <i></i>
            </h2>
            <div class="edit">
                <p class="p1"> 
                    <span>(收货人)</span>
                    <input type="text" placeholder="必填">
                    <em class="error">请填写收货人姓名</em>
                </p>
                <p class="p2">
                    <span>(手机号)</span>
                    <input type="text" maxlength="11" placeholder="必填">
                    <em class="error">请填写手机号</em>
                </p>
                <div class="p3">
                    <span>(所在地区)</span>
                    <div data-toggle="distpicker">
                        <div class="form-group">
                            <select class="form-control" id="province1"></select>
                            <select class="form-control" id="city1"></select>
                            <select class="form-control" id="district1"></select>
                        </div>
                    </div>
                </div>
                <p class="p4"> 
                    <span>(详细地址)</span>
                    <input type="text" placeholder="街道门牌">
                    <em class="error">请填写详细地址</em>
                </p>
                <p class="p5">
                    <i></i>
                    <span>设为默认</span>
                </p>
            </div>
            <div class="footer">
                <button class="btn1">保存并使用</button>
                <button class="btn2">取消</button>
            </div>
        </div>
    </div>
    <script src="http://www.jq22.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://www.jq22.com/jquery/bootstrap-3.3.4.js"></script>
    <script src="js/distpicker.data.js"></script>
    <script src="js/distpicker.js"></script>
    <script src="js/main.js"></script>
    <script>
      
        $(function() {
            
            $(".span2").click(function() {
                if($(this).hasClass("changeSpan")) {   //是否优惠加购
                    $(this).removeClass("changeSpan")
                    $(this).text("+优惠加购");
                    $(".priceAdd").eq($(".span2").index($(this))).text("￥0")
                }else {
                    $(this).addClass("changeSpan")
                    $(this).text("取消加购");
                    $(".priceAdd").eq($(".span2").index($(this))).text($(".span1 span:first-child").eq($(".span2").index($(this))).text())
                }
            })

            $(".msg_area").keyup(function() {  //留言文本键入字符长度
                $(".leave_msg span").text($(this).val().length+"/200")
            })

            //默认地址
            $(".edit .p5 i").click(function() {
                if($(this).hasClass("light")) {
                    $(this).removeClass("light")
                }else {
                    $(this).addClass("light")
                }
            })

            //添加收货地址
            $(".addAddress").click(function() {  //初始化地址信息
                $(".shade").css("display","block")
                $(".edit_box h2 span").text("添加收货地址")
                $("#province1").children().eq(1).removeAttr("selected")
                $("#province1").children().removeAttr("selected")
                $("#province1").children().eq(0).attr("selected")
                $("#province1").siblings().hide(); 
                $(".edit .p1 input").val("")
                $(".edit .p2 input").val("")
                $(".edit .p4 input").val("")
            })
            $(".edit_box h2 i").click(function() {
                $(".shade").removeAttr("style")
                $(".footer .btn1").removeClass("amend")
            })
            $(".footer .btn2").click(function() {
                $(".shade").removeAttr("style")
                $(".footer .btn1").removeClass("amend")
            })
            
            $(".footer .btn1").click(function() {
                //匹配收货地址信息 格式错误提示
                if(!/[\S]/.test($(".edit .p1 input").val())) {
                    $(".edit>p em").eq(0).css("display","block");
                    $(".edit .p1 span").css("color","#cc5252")
                }else if(!/^1[34578]\d{9}$/.test($(".edit .p2 input").val())){
                    $(".edit>p em").eq(1).css("display","block");
                    $(".edit .p2 span").css("color","#cc5252")
                }else if($("#province1").val()==$("#province1 option").eq(0).val()) {
                    $("#province1").css("border","1px solid #cc5252")
                    $(".edit .p3 span").css("color","#cc5252")
                }else if(!/[\S]/.test($(".edit .p4 input").val())) {
                    $(".edit>p em").eq(2).css("display","block");
                    $(".edit .p4 span").css("color","#cc5252")
                }else {    //正则匹配成功后创建地址信息或修改地址信息
                    if(!$(this).hasClass("amend")) {   //添加地址
                        $(".L_address ul").append(
                        `
                        <li>
                            <p class="p1">
                                <span class="Name">${$(".edit .p1 input").val()}</span>
                                <span class="phone">${$(".edit .p2 input").val()}</span>
                                <i>默认</i>
                            </p>
                            <div>
                                <p class="p2">
                                    <i></i>
                                    <span>${$("#province1").val()}</span>
                                    <span>${$("#city1").val()}</span>
                                    <span>${$("#district1").val()}</span>
                                </p>
                                <p class="p3">${$(".edit .p4 input").val()}</p>
                                <i></i>
                            </div>
                            <span class="hover">编辑</span>
                        </li>
                        `
                    )
                    }else {  //修改地址
                        $(".L_address ul .Name").eq($(".L_address ul li").index($(".changeBorder"))).text($(".edit .p1 input").val())
                        $(".L_address ul .phone").eq($(".L_address ul li").index($(".changeBorder"))).text($(".edit .p2 input").val())
                        $(".L_address ul .p3").eq($(".L_address ul li").index($(".changeBorder"))).text($(".edit .p4 input").val())
                        $(".L_address ul .p2 span:nth-child(2)").eq($(".L_address ul li").index($(".changeBorder"))).text($("#province1").val())
                        $(".L_address ul .p2 span:nth-child(3)").eq($(".L_address ul li").index($(".changeBorder"))).text($("#city1").val())
                        $(".L_address ul .p2 span:nth-child(4)").eq($(".L_address ul li").index($(".changeBorder"))).text($("#district1").val())
                    }   
                    
                    $(".shade").removeAttr("style")
                    $(this).removeClass("amend")
                }
                $(".L_address .hover").on("click",function() {  
                    $(".footer .btn1").addClass("amend");
                    $(".shade").css("display","block");
                    $(".edit_box h2 span").text("编辑收货地址")
                    $("#city1").children().eq(0).removeAttr("selected")
                    $("#district1").children().eq(0).attr("selected")
                    $("#province1").siblings().show(); 
                    $(".edit .p1 input").val($(".L_address ul .Name").eq($(this).parent().index()).text())
                    $(".edit .p2 input").val($(".L_address ul .phone").eq($(this).parent().index()).text())
                    $(".edit .p4 input").val($(".L_address ul .p3").eq($(this).parent().index()).text())
                })
                //切换地址信息
                $(".L_address ul li").click(function() {
                    if(!$(this).hasClass("changeBorder")) {
                        $(this).addClass("changeBorder").siblings().removeClass("changeBorder")
                        $(".L_address ul li>div>i").css("display","block").not($(".L_address ul li>div>i").eq($(".L_address ul li").index($(this)))).removeAttr("style")
                        $(".L_address ul .p2 i").css("background-position","-280px -296px").not($(".L_address ul .p2 i").eq($(".L_address ul li").index($(this)))).removeAttr("style")
                        $(".L_address ul .p1").css("color","#cc5252").not($(".L_address ul .p1").eq($(".L_address ul li").index($(this)))).removeAttr("style")
                    }
                }) 
                $(".L_address ul li").eq($(".L_address ul li").length-1).addClass("changeBorder")   
                if($(".L_address ul li").eq($(".L_address ul li").length-1).hasClass("changeBorder")) {
                    $(".L_address ul li").eq($(".L_address ul li").length-1).addClass("changeBorder").siblings().removeClass("changeBorder")
                    $(".L_address ul li>div>i").css("display","block").not($(".L_address ul li>div>i").eq($(".L_address ul li").length-1)).removeAttr("style")
                    $(".L_address ul .p2 i").css("background-position","-280px -296px").not($(".L_address ul .p2 i").eq($(".L_address ul li").length-1)).removeAttr("style")
                    $(".L_address ul .p1").css("color","#cc5252").not($(".L_address ul .p1").eq($(".L_address ul li").length-1)).removeAttr("style")
                }
            })
            $(".edit>p input").keyup(function() {  //修改错误信息移除提示
                $(this).parent().children().removeAttr("style")
            })

            //更改原插件默认格式
            $("#province1").change(function() {
                $("#province1").removeAttr("style")  
                $(".edit .p3 span").removeAttr("style")  
                $("#district1").children().eq(0).remove();
                $("#city1").children().eq(0).remove();       
                if($(this).val()==$("#province1 option").eq(0).val()) {
                    $(this).siblings().hide();
                }else {
                    $(this).siblings().show();
                }
            })
             $("#city1").change(function() {
                $("#district1").children().eq(0).remove();
            })

            $(".add").click(function() {
                $(".L_title h2 span").text($(".number").val())
            }) 
            $(".sub").click(function() {
                $(".L_title h2 span").text($(".number").val())
            })
            
            //编辑初始化地址信息
            // $(".L_address .hover").click(function() {
            //     $(".footer .btn1").addClass("amend");
            //     $(".shade").css("display","block");
            //     $(".edit_box h2 span").text("编辑收货地址")
            //     $("#province1").siblings().show(); 
            //     $(".edit .p1 input").val($(".L_address ul .Name").eq($(".L_address hover").index($(this))).text())
            //     $(".edit .p2 input").val($(".L_address ul .phone").eq($(".L_address hover").index($(this))).text())
            //     $(".edit .p4 input").val($(".L_address ul .p3").eq($(".L_address hover").index($(this))).text())
            // })
            //编辑创建的信息
            $(".shopList ul").eq(0).append(localStorage.getItem("list"))
            console.log(localStorage.getItem("list"))

            

        })
    </script>
</body>
</html>